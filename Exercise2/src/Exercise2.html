
<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>List and Viewer</title>
        <script src="https://cdn.tailwindcss.com"></script>

        <style>
                .content:hover{
                        padding: 10px;
                        border: 1px solid black;
                        transition: 0.4s;
                }
        </style>
</head>

<body>
        <div class="grid gap-5 grid-cols-2 mt-10 ml-10 ">
                <div>
                        <h1 class="font-bold font-sans hover:font-serif text-3xl text-center p-5 bg-gray-100 w-[50vw] m-auto mt-5">Find your favorite üçª?</h1>
                        <div class="m-auto border w-[50vw] h-[60vh] flex flex-col gap-3 bg-gray-100 p-3 overflow-y-scroll "
                                id="display" onclick="viewdata(id)">
                                <div id="sub-container"></div>
                        </div>
                </div>
                <div class="m-auto border w-[40vw] h-[70vh] bg-gray-100 p-3 ">
                        <div id="listdata"></div>
                </div>
        </div>
        <script>
                let disElement = document.getElementById("display");
                let listdataEle = document.getElementById("listdata");
                let currpage = 1;
                let dataLoading = false;
                let stobj = "";

                const loadingEle = (page) => {
                        dataLoading = true;
                        console.log("Page " + page);
                        if(localStorage.getItem('pagenum')>currpage){
                                const getEle = localStorage.getItem(`thingpages:${currpage}`);
                                let things = JSON.parse(getEle);
                                things.forEach(result => {
                                        stobj += `
                                                        <div class="content bg-blue-100 w-full p-[2.5vh] flex " id="content">
                                                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTElvWKo9pGH9cTYopc13qv6C8rSeMRK1ItPg&usqp=CAU" width="10%">
                                                                <div class="pl-5">
                                                                        <span class="font-semibold" >${result["name"]}</span> 
                                                                         <p>${result["tagline"]}</p>
                                                                </div>
                                                               
                                                        </div>`
                                })
                                disElement.innerHTML = stobj;
                                currpage++;
                                dataLoading = false;
                        }
                        else{
                                 fetch(`https://api.punkapi.com/v2/beers?page=${page}&per_page=10`)
                                .then(async (res) => {
                                        let rs = await res.json();
                                        console.log(rs);
                                        // let data = rs.data
                                        localStorage.setItem(`thingpages:${page}`,JSON.stringify(rs));
                                        rs.forEach(result => {
                                                stobj += `
                                                        <div class="content bg-blue-100 w-full p-[2.5vh] flex " id="content">
                                                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTElvWKo9pGH9cTYopc13qv6C8rSeMRK1ItPg&usqp=CAU" width="10%">
                                                                <div class="pl-5">
                                                                        <span class="font-semibold" >${result["name"]}</span> 
                                                                         <p>${result["tagline"]}</p>
                                                                </div>
                                                               
                                                        </div>`
                                        });
                                        disElement.innerHTML = stobj;
                                        currpage++;
                                        localStorage.setItem('pagenum',currpage);
                                        dataLoading = false;
                                })
                        } 
                }
                function viewdata(id) {
                        for(let thing of fav){
                                for(let element of pages){
                                        if(element.id == id){
                                                listdata.innerHTML += `
                                                        <center class="box">
                                                                <h3 class="font-semibold">${element.name}.[0]</h3>
                                                                <p class="mb-4">${element.first_brewed}.[0]</p>
                                                                <p class="font-[500] mb-4">${element.description}</p>
                                                                <hr>
                                                        </center>
                                                `
                                        }
                                }
                        }          
                }
                disElement.addEventListener("scroll", (event) => {
                                        const { scrollTop, clientHeight, scrollHeight } = disElement;
                                        if ((clientHeight + scrollTop) >= scrollHeight * 0.95) {
                                                if (!dataLoading) {
                                                        loadingEle(currpage);
                                                }
                                        }
                                });
                                loadingEle(currpage);
        </script>
</body>

</html>